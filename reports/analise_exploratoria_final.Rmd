---
title: "analise_exploratoria_final"
author: "devjaynemorais"
date: "4 de julho de 2019"
output: 
  html_notebook:
    theme: lumen
    fig_width: 7
    toc: true
    toc_float: true
    code_folding: hide
editor_options: 
  chunk_output_type: inline
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
theme_set(theme_bw())
library(ggridges)
library(ggplot2)
library(broom)

knitr::opts_chunk$set(tidy = FALSE,
                      fig.width = 6,
                      fig.height = 5)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
dados = read_csv(here::here("data/merged.csv"))
glimpse(dados)
```

Análise 
```{r}
#dados %>% 
   # ggplot(aes(x = confidence)) + 
   # geom_density(alpha=0.55) +
   # scale_x_continuous(breaks = seq(from = 0, to = 1, by = 0.1))  +
   # scale_y_continuous(breaks = seq(from = 0, to = 30000, by = 2000)) +
   # labs(
      #    title = "Distribuição da confiança de detecção",
      #    y = "Quantidade de valores de Confiança",
      #    x = "Valor de Confiança" 
     # )  


dados %>% 
    ggplot(aes(x = confidence)) + 
    geom_histogram(binwidth = 0.1, aes(fill = ..count..) ) +
    scale_x_continuous(breaks = seq(from = 0, to = 1, by = 0.1))  +
    scale_y_continuous(breaks = seq(from = 0, to = 30000, by = 2000)) +
    labs(
        title = "Distribuição da Confiança de detecção",
        y = "Quantidade de valores de Confiança",
        x = "Valor de Confiança" 
    )+ guides(fill=guide_legend("Quantidade"))

ggsave("explora_dados_de_confianca.pdf", width = 5 , height = 4)
    

```

```{r}
dados %>% 
    group_by(resolution) %>% 
    summarise(media_confidence = mean(confidence))

```

```{r}
dados %>% 
    group_by(object_name, resolution) %>% 
    summarise(media_confidence = mean(confidence))
    
```



## Com ICs


```{r}
theta_confianca = function(d, i){
    confiancas = d %>% 
        slice(i) %>% 
        summarise(media_confianca = mean(confidence))
    
    fpcc = confiancas %>% pull(media_confianca)
    
    fpcc
}


theta_c_fds = theta_confianca(dados, 1:NROW(dados))

theta_c_fds
```

```{r}
library(boot)
dados %>% 
    boot(statistic = theta_confianca, R = 2000) %>% 
    tidy(conf.level = 0.95, 
         conf.int = TRUE)
```